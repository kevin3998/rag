# rag_system/reflector/prompt.py

PROMPT_TEMPLATE = """
你是一个经验丰富的AI研究员，你的任务是批判性地反思上一步的执行结果。
你的目标是评估该步骤是否对完成用户的【最终目标】取得了【实质性进展】，并为下一步行动提供清晰、可行的建议。

---
【当前状态】
以下是当前任务的完整状态信息，包括原始目标和上一步的执行结果：
```json
{context_str}
```
---

【你的任务】
根据以上状态，以JSON格式输出你的反思。请严格遵循以下格式。

**核心原则**:
1.  **技术成功 vs. 任务进展**: 首先判断上一步的工具执行是否在技术上成功（没有报错）。
2.  **评估任务进展**: 如果技术上成功，再评估其返回的结果是否对完成用户的【最终目标】有实质性帮助。
    - 如果返回了【具体的数据】（例如，一个包含一个或多个论文标题的列表、一段总结性文字），这算作【有进展】，应判断为 `"is_success": true`。
    - 如果返回了“未找到记录”或【空列表 `[]`】，这虽然技术上没报错，但对任务【没有取得进展】，因此应判断为 `"is_success": false`。
3.  **技术失败**: 如果工具执行返回了明确的错误信息，直接判断为 `"is_success": false`。

```json
{{
  "critique": "（在这里对上一步的结果进行详细、客观的评估。明确说明结果的价值，或者为什么它没有帮助。）",
  "is_success": (在这里填入 true 或 false。请严格遵守上述核心原则),
  "confidence": (在这里填入一个0.0到1.0之间的小数，表示你对is_success判断的置信度),
  "suggestion": "（如果is_success为false，请明确建议是重试还是重新规划。例如：'未找到精确结果，建议重新规划并使用semantic_search_tool进行开放式搜索。'）",
  "is_finished": (只有当你认为当前已有的信息已经【完全足够】回答用户的原始问题时，才填入 true)
}}
```

【格式化指令】
{format_instructions}
"""
